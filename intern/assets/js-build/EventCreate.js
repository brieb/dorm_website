var EventCreate={};EventCreate={urlEventCreate:SITE_URL+"/event/create",urlEventView:SITE_URL+"/event/view",container:null,containerButtons:null,containerFields:null,containerSignUp:null,submitButton:null,submitButtonContainer:null,sidebar:null,signUpEnabled:!1,signUpForm:null,setSignUpForm:function(a){this.signUpForm=a},signUpCapacity:0,setSignUpCapacity:function(a){this.signUpCapacity=a},init:function(a,b){this.container=$("#"+b),this.sidebar=$("#"+a),this.containerButtons=$("<div />").attr({"class":"sidebar-box"}),this.containerFields=$("<form/>").attr({id:"event_create_fields"}),$("#main").append(this.containerButtons),this.container.append(this.containerFields),this.submitButton=$("<button />").button({label:"Create Event"}),this.submitButtonContainer=$("<div />").attr({"class":"sidebar-box"}).append(this.submitButton),this.submitButton.click(function(){this.addLoadingIndicatorToButton(this.submitButton),$.post(this.urlEventCreate,this.serialize(),function(a){this.removeLoadingIndicatorFromButton(this.submitButton),window.location=this.urlEventView+"/"+a}.bind(this))}.bind(this)),this.containerButtons.append($("<button/>").attr({name:"button_field_add[SignUp]"}).text("SignUp").button().click(function(a){var b=$(a.currentTarget);this.containerSignUp=$("<div/>").addClass("sidebar-box"),this.submitButtonContainer.after(this.containerSignUp),b.blur().mouseleave().button("disable"),this.signUpCreate()}.bind(this))),$.each(this.fieldTypes,function(a,b){if(b.isDefault){var c=this.genFieldType(b);this.containerFields.append(c)}else this.containerButtons.append($("<button/>").attr({name:"button_field_add["+b.name+"]"}).text(b.pretty).button().click(function(a){var c=$(a.currentTarget);c.blur().mouseleave().button("disable");var d=this.genFieldType(b);this.containerFields.append(d)}.bind(this)))}.bind(this)),this.sidebar.append(this.submitButtonContainer,$("<div />").attr({"class":"sidebar-box-wrapper"}).append($("<div />").attr({"class":"label"}).text("Add Fields:"),this.containerButtons)),this.containerSignUp=$("<div/>"),this.submitButtonContainer.after(this.containerSignUp)},serialize:function(){var a=$(this.containerFields).serialize();this.signUpEnabled&&(a+="&"+$.param({"SignUp[enabled]":!0}),a+="&"+$.param({"SignUp[capacity]":this.signUpCapacity})),this.signUpForm!==null&&(a+="&"+$.param({"SignUp[form]":this.signUpForm})),a.replace(/%5B%5D/g,"[]");return a},signUpCreate:function(){EventCreateSignUpWizard.init(),this.containerSignUp.append($("<button/>").text("Remove Sign Up").button().click(function(a){this.containerSignUp.remove(),this.signUpClear(),EventCreateSignUpWizard.reset(),$('button[name="button_field_add[SignUp]"]').blur().mouseleave().button("enable")}.bind(this)))},signUpClear:function(){this.signUpEnabled=!1,this.signUpForm=null,this.signUpCapacity=0},fieldTypes:{title:{name:"title",pretty:"Title",isDefault:!0,fields:[{identifier:"title",label:"Title: ",placeholder:"End of the Year Banquet"}]},datetime:{name:"time",pretty:"Time and Date",isDefault:!0,fields:[{identifier:"time[start]",label:"From: ",inputType:"datetimepicker"},{identifier:"time[end]",label:"To: ",inputType:"datetimepicker"}]},description:{name:"description",pretty:"Description",isDefault:!0,fields:[{identifier:"description",label:"Description: ",inputType:"textarea",placeholder:""}]},meetupInfo:{name:"MeetupInfo",pretty:"Meetup Info",isDefault:!1,fields:[{identifier:"form_builder[MeetupInfo][info]",label:"Info: ",placeholder:"ex: Schaddify at 10pm"}]},eventLocation:{name:"EventLocation",pretty:"Event Location",isDefault:!1,fields:[{identifier:"form_builder[EventLocation][location]",label:"Location: ",placeholder:""}]},payment:{name:"Payment",pretty:"Payment",isDefault:!1,fields:[{identifier:"form_builder[Payment][price]",label:"Price: ",placeholder:"$10.00"},{identifier:"form_builder[Payment][instructions]",label:"Instructions: ",placeholder:"ex: Slide it under [Staff Memeber]'s door"}]},pointPerson:{name:"PointPerson",pretty:"Point Person",isDefault:!1,fields:[{identifier:"form_builder[PointPerson][person]",label:"Person: ",placeholder:""}]}},genFieldset:function(a,b){return $("<fieldset/>").append($("<legend/>").text(a.pretty),b,$("<button/>").attr({name:"button_field_remove["+a.name+"]","class":"button_remove"}).button({icons:{primary:"ui-icon-trash"}}).click(function(b){var c=$(b.target);c.parents("fieldset").remove(),$('button[name="button_field_add['+a.name+']"]').blur().mouseleave().button("enable")}.bind(this)))},genFieldType:function(a){var b=this.genFormInput(a.fields);return a.isDefault===!0?b:this.genFieldset(a,b)},genFormInput:function(a){var b=a.map(function(a){a.inputType===undefined&&(a.inputType="input");if(a.inputType==="datetimepicker"){var b={ampm:!0,stepHour:1,stepMinute:5},c=$("<div/>").attr({"class":"field"}).append($("<label />").attr({"for":a.identifier}).text(a.label),$("<br />"),$("<input/>").attr({type:"text",id:a.identifier,name:a.identifier}).datetimepicker(b).datetimepicker("setDate",new Date));$("#ui-datepicker-div").hide();return c}var d=$("<label/>").attr({"for":a.identifier}).text(a.label),e=$("<"+a.inputType+"/>").attr({name:a.identifier,id:a.identifier,placeholder:a.placeholder});a.inputType==="input"&&e.attr({type:"text"});return $("<div/>").attr({"class":"field"}).append(d,$("<br />"),e)}),c=$("<div/>");b.map(function(a){c.append(a)});return c},addLoadingIndicatorToButton:function(a){a.mouseleave(),a.append($("<span/>").attr({"class":"loading_indicate"}))},removeLoadingIndicatorFromButton:function(a){a.remove(".loading_indicate")}}