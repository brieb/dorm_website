var EventEdit={};EventEdit={data:null,signUpDelete:0,url:SITE_URL+"/event/edit/",urlView:SITE_URL+"/event/view",urlDelete:SITE_URL+"/event/delete/",container:null,sidebar:null,init:function(a,b,c){this.container=$("#"+b),this.sidebar=$("#"+a),this.data=c,this.url+=this.data.id,this.urlDelete+=this.data.id,EventCreate.init(a,b),this.setUpDelete(),EventCreate.submitButton.button("option","label","Finish Editing Event"),EventCreate.submitButton.unbind("click").click(function(){var a=EventCreate.serialize();a+="&sign_up_delete="+this.signUpDelete,a+="&sign_up_id="+this.data.sign_up_id,a+="&id="+this.data.id,EventCreate.addLoadingIndicatorToButton(EventCreate.submitButton),$.post(this.url,a,function(a){EventCreate.removeLoadingIndicatorFromButton(EventCreate.submitButton),window.location=this.urlView+"/"+this.data.id}.bind(this));return!1}.bind(this)),this.replay()},setUpDelete:function(){this.sidebar.append($("<div />").attr({"class":"sidebar-box"}).append($("<button/>").button({label:"Delete Event"}).click(function(){$("<div/>").dialog({title:"Delete Event",modal:!0,buttons:{"Delete Event":function(a){var b=$(a.currentTarget);EventCreate.addLoadingIndicatorToButton(b),$.post(EventEdit.urlDelete,function(a){EventCreate.removeLoadingIndicatorFromButton(b),window.location=EventEdit.urlView,$(this).dialog("close")}.bind(this))},Cancel:function(){$(this).dialog("close")}}}).html($("<p/>").text("Deleting this event will delete the \n                      event information and associated sign ups. \n                      This cannot be undone."))})))},getObjValueByIdentifierArray:function(a,b){var c=b.match(/\w*[^\[\]]/g);for(var d=0;d<c.length;d++)a=a[c[d]];return a},setFieldValue:function(a,b){var c=$(' \n      input[name="'+a+'"],\n      textarea[name="'+a+'"] \n    ');a.substring(0,"time".length)==="time"?c.datetimepicker("setDate",new Date(b)):c.val(b)},replay:function(){$.each(EventCreate.fieldTypes,function(a,b){b.fields.map(function(a){var c=undefined;if(b.isDefault)c=this.getObjValueByIdentifierArray(this.data,a.identifier);else if(this.data.fields[b.name]!==undefined){$('button[name="button_field_add['+b.name+']"]').click();var d=a.identifier.replace(new RegExp("form_builder\\["+b.name+"\\]\\[(.*)\\]"),"$1");c=this.data.fields[b.name][d]}c!==undefined&&this.setFieldValue(a.identifier,c)},this)}.bind(this)),this.data.sign_up_id!==null&&$('button[name="button_field_add[SignUp]"]').unbind("click").click(function(a){var b=$(a.target);b.button("disable"),this.signUpEdit()}.bind(this)).click()},signUpEdit:function(){EventCreate.containerSignUp.addClass("sidebar-box").append($("<button/>").text("Remove Sign Up").button().click(function(a){var b=$(a.target);$("<div/>").html('\n                <p>\n                  <span class="ui-icon ui-icon-alert" \n                    style="float:left; margin:0 7px 20px 0;"></span>\n                  The sign up and all results will be\n                  permanently deleted and cannot be recovered.\n                  Are you sure?\n                </p>\n              ').dialog({title:"Delete Sign Up",resizable:!1,modal:!0,width:350,draggable:!1,buttons:{Cancel:function(){$(this).dialog("close")},"Delete Sign Up":function(){EventEdit.signUpDelete=1,EventCreate.containerSignUp.remove(),EventCreate.signUpClear(),$('button[name="button_field_add[SignUp]"]').blur().mouseleave().button("enable").unbind("click").click(function(a){var b=$(a.target);b.button("disable"),EventCreate.signUpCreate()}),$(this).dialog("close")}}})}.bind(this)))}}