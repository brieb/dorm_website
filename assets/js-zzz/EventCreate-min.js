var EventCreate={};EventCreate={urlEventCreate:SITE_URL+"/event/create",urlEventView:SITE_URL+"/event/view",container:null,containerButtons:null,containerFields:null,containerSignUp:null,submitButton:null,submitButtonContainer:null,sidebar:null,signUpEnabled:false,signUpForm:null,setSignUpForm:function(a){this.signUpForm=a},signUpCapacity:0,setSignUpCapacity:function(a){this.signUpCapacity=a},init:function(b,a){this.container=$("#"+a);this.sidebar=$("#"+b);this.containerButtons=$("<div />").attr({"class":"sidebar-box"});this.containerFields=$("<form/>").attr({id:"event_create_fields"});$("#main").append(this.containerButtons);this.container.append(this.containerFields);this.submitButton=$("<button />").button({label:"Create Event"});this.submitButtonContainer=$("<div />").attr({"class":"sidebar-box"}).append(this.submitButton);this.submitButton.click(function(){$.post(this.urlEventCreate,this.serialize(),function(c){window.location=this.urlEventView+"/"+c}.bind(this))}.bind(this));this.containerButtons.append($("<button/>").attr({name:"button_field_add[SignUp]"}).text("SignUp").button().click(function(c){var d=$(c.currentTarget);this.containerSignUp=$("<div/>").addClass("sidebar-box");this.submitButtonContainer.after(this.containerSignUp);d.blur().mouseleave().button("disable");this.signUpCreate()}.bind(this)));$.each(this.fieldTypes,function(c,d){if(d.isDefault){var e=this.genFieldType(d);this.containerFields.append(e)}else{this.containerButtons.append($("<button/>").attr({name:"button_field_add["+d.name+"]"}).text(d.pretty).button().click(function(f){var h=$(f.currentTarget);h.blur().mouseleave().button("disable");var g=this.genFieldType(d);this.containerFields.append(g)}.bind(this)))}}.bind(this));this.sidebar.append(this.submitButtonContainer,$("<div />").attr({"class":"sidebar-box-wrapper"}).append($("<div />").attr({"class":"label"}).text("Add Fields:"),this.containerButtons));this.containerSignUp=$("<div/>");this.submitButtonContainer.after(this.containerSignUp)},serialize:function(){var a=$(this.containerFields).serialize();if(this.signUpEnabled){a+="&"+$.param({"SignUp[enabled]":true});a+="&"+$.param({"SignUp[capacity]":this.signUpCapacity})}if(this.signUpForm!==null){a+="&"+$.param({"SignUp[form]":this.signUpForm})}a.replace(/%5B%5D/g,"[]");return a},signUpCreate:function(){EventCreateSignUpWizard.init();this.containerSignUp.append($("<button/>").text("Remove Sign Up").button().click(function(a){this.containerSignUp.remove();this.signUpClear();EventCreateSignUpWizard.reset();$('button[name="button_field_add[SignUp]"]').blur().mouseleave().button("enable")}.bind(this)))},signUpClear:function(){this.signUpEnabled=false;this.signUpForm=null;this.signUpCapacity=0},fieldTypes:{title:{name:"title",pretty:"Title",isDefault:true,fields:[{identifier:"title",label:"Title: ",placeholder:"End of the Year Banquet"}]},datetime:{name:"time",pretty:"Time and Date",isDefault:true,fields:[{identifier:"time[start]",label:"From: ",inputType:"datetimepicker"},{identifier:"time[end]",label:"To: ",inputType:"datetimepicker"}]},description:{name:"description",pretty:"Description",isDefault:true,fields:[{identifier:"description",label:"Description: ",inputType:"textarea",placeholder:""}]},meetupInfo:{name:"MeetupInfo",pretty:"Meetup Info",isDefault:false,fields:[{identifier:"form_builder[MeetupInfo][info]",label:"Info: ",placeholder:"ex: Schaddify at 10pm"}]},eventLocation:{name:"EventLocation",pretty:"Event Location",isDefault:false,fields:[{identifier:"form_builder[EventLocation][location]",label:"Location: ",placeholder:""}]},payment:{name:"Payment",pretty:"Payment",isDefault:false,fields:[{identifier:"form_builder[Payment][price]",label:"Price: ",placeholder:"$10.00"},{identifier:"form_builder[Payment][instructions]",label:"Instructions: ",placeholder:"ex: Slide it under [Staff Memeber]'s door"}]},pointPerson:{name:"PointPerson",pretty:"Point Person",isDefault:false,fields:[{identifier:"form_builder[PointPerson][person]",label:"Person: ",placeholder:""}]}},genFieldset:function(b,a){return $("<fieldset/>").append($("<legend/>").text(b.pretty),a,$("<button/>").attr({name:"button_field_remove["+b.name+"]","class":"button_remove"}).button({icons:{primary:"ui-icon-trash"}}).click(function(c){var d=$(c.target);d.parents("fieldset").remove();$('button[name="button_field_add['+b.name+']"]').blur().mouseleave().button("enable")}.bind(this)))},genFieldType:function(a){var b=this.genFormInput(a.fields);if(a.isDefault===true){return b}return this.genFieldset(a,b)},genFormInput:function(c){var b=c.map(function(h){if(h.inputType===undefined){h.inputType="input"}if(h.inputType==="datetimepicker"){var f={ampm:true,stepHour:1,stepMinute:5};var g=$("<div/>").attr({"class":"field"}).append($("<label />").attr({"for":h.identifier}).text(h.label),$("<br />"),$("<input/>").attr({type:"text",id:h.identifier,name:h.identifier}).datetimepicker(f).datetimepicker("setDate",new Date()));$("#ui-datepicker-div").hide();return g}else{var e=$("<label/>").attr({"for":h.identifier}).text(h.label);var d=$("<"+h.inputType+"/>").attr({name:h.identifier,id:h.identifier,placeholder:h.placeholder});if(h.inputType==="input"){d.attr({type:"text"})}return $("<div/>").attr({"class":"field"}).append(e,$("<br />"),d)}});var a=$("<div/>");b.map(function(d){a.append(d)});return a}};