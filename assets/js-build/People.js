var People={};People={users:null,init:function(a){this.users=a,$("#user_search").keyup(function(){this.print_matching_users()}.bind(this)),$("input:checkbox").click(function(){this.print_matching_users()}.bind(this)),this.print_matching_users()},detect_matching_users:function(){var a="";$('input[name="filter_house[]"]:checked').each(function(){a+="|"+this.value}),a=a.substring(1);var b=new RegExp(a,"i"),c="";$('input[name="filter_floor[]"]:checked').each(function(){c+="|^"+this.value+".*"}),c=c.substring(1);var d=new RegExp(c),e=$("#user_search").val(),f=new RegExp(e,"i"),g={residents:!1,staff:!1};$('input[name="filter_role[]"]:checked').each(function(){g[this.value]=!0});var h={freshman:!1,sophomore:!1,junior:!1,senior:!1,other:!1};$('input[name="filter_class[]"]:checked').each(function(){h[this.value]=!0});for(var i=0;i<this.users.length;i++){var j=this.users[i];j.is_match=!1;if($('input[name="filter_house[]"]:checked').length==0||$('input[name="filter_floor[]"]:checked').length==0)continue;var k=j.staff_role!==null;if(!k&&!g.residents||k&&!g.staff)continue;if(!j["class"]||!h[j["class"].toLowerCase()])continue;var l=[j.first_name,j.nick_name,j.last_name,j.email,j.house,j.staff_role];j.is_match=j.house!==null&&j.house.search(b)>=0&&j.room!==null&&j.room.search(d)>=0;var m=!1;for(var n=0;n<l.length;n++)if(l[n]!==null&&l[n].search(f)>=0){m=!0;break}j.is_match=j.is_match&&m}},print_matching_users:function(){this.detect_matching_users();var a=0,b=0;$("#user_directory_listing").html("");var c=$("<table />"),d=$("<tr />");for(var e=0;e<this.users.length;e++){var f=this.users[e];if(f.is_match===!0){var g=$("<td />"),h=$("<ul />"),i=$("<li/>");i.addClass("photo"),i.append($("<img />").attr({src:BASE_URL+f.photo})),h.append(i);var j=$("<li/>");j.addClass("name");var k=f.first_name;f.nick_name!==null&&(k+=" ("+f.nick_name+")"),k+=" "+f.last_name,j.text(k),h.append(j);var l=$("<li />");l.addClass("email"),l.append($("<a />").attr({href:"mailto:"+f.email}).text(f.email)),h.append(l);var m=$("<li />"),n=f.house;f.room!=="0"&&(n+=" "+f.room),m.text(n),m.addClass("room");if(f["class"]!=="Other"){var o=$("<li />");o.addClass("class"),o.text(f["class"]),h.append(o)}if(f.staff_role!==null){var p=$("<li />").text(f.staff_role).addClass("staff_role");f.staff_role.length>3&&p.addClass("small_text"),h.append(p)}["phone_cell","phone_room","phone_office"].map(function(a){if(f[a]!==null){var b=$("<li/>");b.addClass(a);var c=a.replace(/.*_(.)(.*)/,function(a,b,c){return b.toUpperCase()+c});c+=": "+f[a],b.text(c),h.append(b)}}),g.append(h),d.append(g),a<=b?a++:b++,a===b&&(c.append(d),d=$("<tr />"))}}a>b&&(d.append($("<td />").attr({"class":"empty"})),c.append(d)),$("#user_directory_listing").html(c)}}