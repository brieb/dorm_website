var EventSignUp={};EventSignUp.Form=function(a){this.container=$("#"+a),this.cur_field_content=null,this.container_tabs=$("<div/>").attr({id:"event_sign_up_tabs"}),this.container_content=$("<div/>").attr({id:"event_sign_up_content"}),this.container.append(this.container_tabs,this.container_content);var b=this;this.button_add=$("<button/>").attr({type:"button"}).button({label:"Add Question"}).addClass("button_add").click(function(){var a=new EventSignUp.Field;b.addField(a,!0,!1)}),this.container_tabs.append(this.button_add),this.fields_fixed=[new EventSignUp.FieldFixed("Name & Email Address","Names and email addresses are automatically collected.")];for(var c=0;c<this.fields_fixed.length;c++)this.addField(this.fields_fixed[c],c===0,!0);this.fields=[]},$.extend(EventSignUp.Form.prototype,{addField:function(a,b,c){var d=a.getContent();this.container_content.append(d),d.hide();var e=$("<div/>").html(a.getTab()),f=$("<div/>").append(e);if(!c){this.fields.push(a);var g=$("<button/>").attr({type:"button"}).button({icons:{primary:"ui-icon-close"},text:!1}).click(function(){h.removeField(a,i)});f.prepend(g),a.getQuestionTextInput().keyup(function(){e.html(a.getTab())})}var h=this,i=$("<div/>").addClass("tab").html(f).click(function(){h.cur_field_content!==null&&h.cur_field_content.hide(),h.cur_field_content=d,h.cur_field_content.show(),c||a.getQuestionTextInput().focus(),$(".tab").removeClass("active"),$(this).addClass("active")});this.button_add.before(i),b&&i.click()},removeField:function(a,b){b.remove(),a.getContent().remove(),this.fields=$.grep(this.fields,function(b){return b!==a})},serialize:function(){var a=[];for(var b=0;b<this.fields.length;b++){var c=this.fields[b];a.push(c.serialize())}return a}}),EventSignUp.FieldFixed=function(a,b){this.label=a,this.content=b},$.extend(EventSignUp.FieldFixed.prototype,{getTab:function(){return $("<div/>").text(this.label)},getContent:function(){return $("<div/>").text(this.content)}}),EventSignUp.Field=function(){this.content="",this.content_sub_field=$("<div/>"),this.sub_field=null,this.type="",this.question_text_input=$("<input/>").attr({type:"text","class":"width_full"}),this.type_selector=$("<select/>");var a=this,b={multiple_choice:"radio",checkboxes:"checkbox",choose_from_a_list:"list"};this.type_selector.change(function(){var c=$(this).val();a.type=c,a.sub_field=null,a.content_sub_field.empty(),typeof b[c]!="undefined"&&(a.sub_field=new EventSignUp.SubFieldChoices(b[c]),a.content_sub_field.html(a.sub_field.getContent()))}),this.types=[{type:"text",label:"Text"},{type:"paragraph_text",label:"Paragraph"},{type:"multiple_choice",label:"Multiple Choice"},{type:"checkboxes",label:"Checkboxes"},{type:"choose_from_a_list",label:"Choose from a List"}];for(var c=0;c<this.types.length;c++){var d=this.types[c];this.type_selector.append($("<option/>").attr({value:d.type}).text(d.label))}this.content=$("<div/>").append($("<div/>").attr({"class":"label"}).text("Question: "),this.question_text_input,$("<div/>").attr({"class":"label"}).text("Type: "),this.type_selector,this.content_sub_field)},$.extend(EventSignUp.Field.prototype,{getTab:function(){var a=this.question_text_input.val();return a===""?"(untitled)":a},getContent:function(){this.type_selector.uniform();return this.content},getQuestionTextInput:function(){return this.question_text_input},serialize:function(){var a={text:this.question_text_input.val(),type:this.type,choices:""};this.sub_field!==null&&(a.choices=this.sub_field.serialize());return a}}),EventSignUp.SubFieldChoices=function(a){this.type=a,this.container_choices=$("<div/>"),this.container_choices.append(this.genChoice())},$.extend(EventSignUp.SubFieldChoices.prototype,{getContent:function(){return $("<div/>").addClass("subfield").append(this.container_choices,this.genDummy())},serialize:function(){var a=[],b=this.container_choices.find('input[type="text"]');for(var c=0;c<b.length;c++){var d=$(b[c]);a.push(d.val())}return a},genDummy:function(){var a=this;return $("<button/>").attr({type:"button"}).addClass("sign_up_field_button").button({label:"Add Another Choice"}).click(function(){var b=a.genChoice();a.container_choices.append(b),b.find('input[type="text"]').focus()})},genChoice:function(){var a=$("<div/>").addClass("width_full"),b=$("<div/>").addClass("sign_up_remove_choice").append($("<button/>").attr({type:"button"}).button({icons:{primary:"ui-icon-close"},text:!1}).click(function(){a.remove()}));a.append(b);var c=$("<div/>");this.type!==null&&this.type!=="list"?(c.addClass("has_input_placeholder"),c.append($("<input />").attr({type:this.type,disabled:"disabled"}))):c.addClass("no_input_placeholder"),c.append($("<input />").attr({type:"text",placeholder:"Enter Choice Text Here"})),a.append(c);return a}})